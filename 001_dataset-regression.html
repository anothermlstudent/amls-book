
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Regression Dataset &#8212; amls</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "github-org/github-repo");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://anothermlstudent.github.io/amls-book/001_dataset-regression.html" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Bias-Variance trade-off (theory)" href="003_bias-vs-variance%28theory%29.html" />
    <link rel="prev" title="Welcome to another machine learning student (note)book" href="intro.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://anothermlstudent.github.io/amls-book/001_dataset-regression.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Regression Dataset" />
<meta property="og:description" content="Regression Dataset  En la práctica, nunca vamos a conocer el verdadero proceso que genera los datos (si lo conocieramos, no necesitaríamos utilizar técnicas de " />
<meta property="og:image"       content="https://anothermlstudent.github.io/amls-book/_static/logo-amls.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo-amls.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">amls</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to another machine learning student (note)book
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Regression Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="003_bias-vs-variance%28theory%29.html">
   Bias-Variance trade-off (theory)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="005_bias-vs-variance%28practice%29.html">
   Bias-Variance trade-off (practice, my notes)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007_gaussian-processes.html">
   Gaussian Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="994_jupyterbook_cookbook.html">
   Jupyter book - Recetas básicas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="996_ploting-tools.html">
   Different ploting tools
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="997_appendix.html">
   Apprendix
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/001_dataset-regression.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/anothermlstudent/amls-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/anothermlstudent/amls-book/issues/new?title=Issue%20on%20page%20%2F001_dataset-regression.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/anothermlstudent/amls-book/edit/main/amls/001_dataset-regression.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/anothermlstudent/amls-book/main?urlpath=tree/amls/001_dataset-regression.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/anothermlstudent/amls-book/blob/main/amls/001_dataset-regression.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-synthetic-dataset">
   The (synthetic) dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-distribution-pr-x-y">
   Data distribution
   <span class="math notranslate nohighlight">
    \(Pr(X,Y)\)
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-trianing-datasets">
   The trianing datasets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#true-f-for-future-reference">
   True
   <span class="math notranslate nohighlight">
    \(f\)
   </span>
   (for future reference)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-test-dataset">
   The test dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#save-the-datasets">
   Save the datasets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ploting-the-datasets">
   Ploting the datasets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="regression-dataset">
<h1>Regression Dataset<a class="headerlink" href="#regression-dataset" title="Permalink to this headline">¶</a></h1>
<p>En la práctica, nunca vamos a conocer el verdadero proceso que genera los datos (si lo conocieramos, no necesitaríamos utilizar técnicas de machine learning). El valor de simular ese proceso, es que nos va permitir conocer exactamente su distribución y eso nos va ayudar a entender que tan buenas son nuestras estimaciones y mejorar nuestra intuición sobre los distintos conceptos y métodos</p>
<div class="section" id="the-synthetic-dataset">
<h2>The (synthetic) dataset<a class="headerlink" href="#the-synthetic-dataset" title="Permalink to this headline">¶</a></h2>
<p>En vez de jugar con datos reales, vamos a crear nuestros datos ya que conocer exactamente como fueron creados nos va ayudar a experimentar con los conceptos que queremos aprender.</p>
<p>Una manera de obtener una fuente de datos infinita es creando una “maquina generadora de datos”. Esa “máquina” la podemos especificar describiendo el proceso a través del cual la “máquina” va a poder generar datos.</p>
<p>Una manera posible, podría ser comenzar con una función <span class="math notranslate nohighlight">\(f\)</span>, donde</p>
<div class="math notranslate nohighlight">
\[f(x) = (0.45x-2)^3 - 0.55(0.2x-3)^2- 2.5(0.5x - 3)+ 5\]</div>
<p>y agregarle ruido <span class="math notranslate nohighlight">\(\epsilon\)</span> para tener entonces una variable aletoria
$<span class="math notranslate nohighlight">\( Y = f(x) + \epsilon.\)</span>$</p>
<p>Para nuestro ejercicio, tomemos <span class="math notranslate nohighlight">\(\epsilon \sim N(\mu=0,\sigma^2 = 0.5)\)</span>.</p>
<p>Para hacerlo todavía más entretenido, vamos a hacer que las <span class="math notranslate nohighlight">\(x\)</span> de nuestro dataset también tengan una distribución, por ejemplo, <span class="math notranslate nohighlight">\(X \sim U(a=0,b=10) \)</span>.</p>
<p>Nota: Elegí una <span class="math notranslate nohighlight">\(f(x)\)</span> con una forma “bastante curva” para que sean más entretenidos nuestros experimentos y nos restringimos a <span class="math notranslate nohighlight">\(x \in [0,10]\)</span> (cómo <span class="math notranslate nohighlight">\(\mathbb{x}\)</span> es un escalar, usamos la notación <span class="math notranslate nohighlight">\(x\)</span> en vez de <span class="math notranslate nohighlight">\(\mathbb{x}\)</span>) para facilitar la visualización.</p>
<p>Con todo esto, nos queda entonces el siguiente proceso de generación de datos: <span class="math notranslate nohighlight">\( Y = f(X) + \epsilon\)</span> , con <span class="math notranslate nohighlight">\(X \sim U(a=0,b=10) \)</span> y <span class="math notranslate nohighlight">\(\epsilon \sim N(\mu=0,\sigma^2 = 0.5)\)</span>.</p>
<p>Para “usar la máquina” en este caso y generar una muestra <span class="math notranslate nohighlight">\((x_0,y_0)\)</span>, empezamos sampleando <span class="math notranslate nohighlight">\(x_0\)</span> de la distribución uniforme, después pasamos <span class="math notranslate nohighlight">\(x_0\)</span> por <span class="math notranslate nohighlight">\(f\)</span> y obtemos <span class="math notranslate nohighlight">\(f(x_0)\)</span>, sampleamos <span class="math notranslate nohighlight">\(\epsilon_0\)</span> de la normal (con <span class="math notranslate nohighlight">\(\mu=0\)</span> y <span class="math notranslate nohighlight">\(\sigma^2 = 0.5\)</span> ) y finalemente obtenemos <span class="math notranslate nohighlight">\(y_0 = f(x_0) + \epsilon_0\)</span>.</p>
<p>Este mismo proceso se puede escribir de la siguiente manera:</p>
<div class="math notranslate nohighlight">
\[ Y|X \sim \mathcal{N}(y|\mu =f(x),{\sigma}^2 = 0.5)\]</div>
<div class="math notranslate nohighlight">
\[ X \sim \mathcal{U}(x|a=0,b=10)\]</div>
<p>Esto se conoce como un modelos jerarquico (<a class="bibtex reference internal" href="#casella-statistical-2001" id="id1">[CB01]</a>, Pag 162) y es para mí una forma muy simple e intuitiva de describir un proceso de generación de datos.</p>
<p>Para “usar la máquina” descripta de esta manera y generar una muestra <span class="math notranslate nohighlight">\((x_0,y_0)\)</span>, empezamos sampleando <span class="math notranslate nohighlight">\(x_0\)</span> de la distribución uniforme. Después, “pasamos” <span class="math notranslate nohighlight">\(x_0\)</span> por <span class="math notranslate nohighlight">\(f\)</span> para obtener <span class="math notranslate nohighlight">\(f(x_0)\)</span>. Finalmente sampleamos <span class="math notranslate nohighlight">\(y_0\)</span> de una normal con <span class="math notranslate nohighlight">\(\mu=f(x_0)\)</span> y <span class="math notranslate nohighlight">\(\sigma^2 = 0.5\)</span>. A este proceso de generar muestras se lo conoce como ancestral sampling (<a class="bibtex reference internal" href="#bishop-pattern-2007" id="id2">[Bis07]</a>, Pag 365).</p>
<p>Noten que las dos descripciones, aunque son ligeramente diferentes, son completamente equivalentes (van a generar datos con exactamente la misma distribución) y me permiten generar tantos pares <span class="math notranslate nohighlight">\((x,y)\)</span> como queramos.</p>
</div>
<div class="section" id="data-distribution-pr-x-y">
<h2>Data distribution <span class="math notranslate nohighlight">\(Pr(X,Y)\)</span><a class="headerlink" href="#data-distribution-pr-x-y" title="Permalink to this headline">¶</a></h2>
<p>En este caso, podemos escribir <span class="math notranslate nohighlight">\(\text{Pr}(X,Y)\)</span> de manera analítica,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\text{Pr}(X,Y) &amp;= \text{Pr}(Y|X) \, \text{Pr}(X) &amp;&amp; \text{(aplicando chain rule)} \\
&amp;= \mathcal{N}(y|\mu =f(x),{\sigma}^2 = 0.5)\, \mathcal{U}(x|a=0,b=10) &amp;&amp; \text{(reemplazando por las definiciones)} \\
&amp;= \frac{1}{\sqrt{2\pi\sigma^2}}\text{exp} \Big\{-\frac{1}{2\sigma^2}(y-f(x))^2\Big\} \frac{1}{b-a} \\
&amp;= \frac{1}{10\sqrt{\pi}}\text{exp} \Big\{-(y-f(x))^2\Big\} &amp;&amp; \text{(reemplazando los valores de los parámetros)} .
\end{align*}\]</div>
<p>Dónde usamos que <span class="math notranslate nohighlight">\(\mathcal{N}(y | \mu,\sigma^2) = \frac{1}{\sqrt{2\pi\sigma^2}}\text{exp} \Big\{-\frac{1}{2\sigma^2}(y-\mu)^2\Big\}\)</span> y <span class="math notranslate nohighlight">\(\mathcal{U}(x|a,b) = \frac{1}{b-a}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>

<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">tree</span>

<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">default_rng</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-trianing-datasets">
<h2>The trianing datasets<a class="headerlink" href="#the-trianing-datasets" title="Permalink to this headline">¶</a></h2>
<p>Generamos los datos usando la descripción de función con ruido.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create d datasets of n samples each</span>
<span class="c1"># X </span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># number of datasets to create</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># samples per dataset</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">10</span> <span class="c1"># x domain range (a,b)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span>  <span class="p">(</span><span class="mf">0.45</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mf">0.55</span><span class="o">*</span><span class="p">(</span><span class="mf">0.2</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># True function that we would like to learn</span>
<span class="n">var</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1"># Noise to add to the true function</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Seed for the random generator</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">default_rng</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate_datasets</span><span class="p">(</span><span class="n">d</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span><span class="n">n</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span><span class="n">f</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">,</span><span class="n">a</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="n">b</span><span class="p">:</span><span class="nb">float</span><span class="p">,</span><span class="n">var</span><span class="p">:</span><span class="nb">float</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates datasets.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    d: number of datasets</span>
<span class="sd">    n: number of samples per dataset</span>
<span class="sd">    f: function to use to generate the data</span>
<span class="sd">    a: min of range x</span>
<span class="sd">    b: max of range x</span>
<span class="sd">    var: variance of the normal use to generate the noise</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    X: datasets with features</span>
<span class="sd">    Y: datasets with targets</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="n">a</span><span class="p">,</span><span class="n">high</span><span class="o">=</span><span class="n">b</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="n">noise</span> <span class="c1"># True labels </span>
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#x_datasets, y_datasets_w_noise = generate_datasets(d,n,f,a,b,var)</span>
<span class="n">X_trains</span><span class="p">,</span> <span class="n">y_trains</span> <span class="o">=</span> <span class="n">generate_datasets</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">var</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d_test</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n_test</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">X_tests</span><span class="p">,</span> <span class="n">y_tests</span> <span class="o">=</span> <span class="n">generate_datasets</span><span class="p">(</span><span class="n">d_test</span><span class="p">,</span><span class="n">n_test</span><span class="p">,</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span><span class="n">var</span><span class="o">=</span><span class="n">var</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="true-f-for-future-reference">
<h2>True <span class="math notranslate nohighlight">\(f\)</span> (for future reference)<a class="headerlink" href="#true-f-for-future-reference" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">true_f_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">true_f_y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">true_f_x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-test-dataset">
<h2>The test dataset<a class="headerlink" href="#the-test-dataset" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d_test</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n_test</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c1">#x_test, y_test_w_noise = generate_datasets(d_test,n_test,f=f,a=a,b=b,var=var)</span>
<span class="n">X_tests</span><span class="p">,</span> <span class="n">y_tests</span> <span class="o">=</span> <span class="n">generate_datasets</span><span class="p">(</span><span class="n">d_test</span><span class="p">,</span><span class="n">n_test</span><span class="p">,</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span><span class="n">var</span><span class="o">=</span><span class="n">var</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="save-the-datasets">
<h2>Save the datasets<a class="headerlink" href="#save-the-datasets" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">to_Xy_df</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a numpy dataset into a dataframe dataset.</span>
<span class="sd">    Assumes X and y with shape (samples).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Xy_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">Xy</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span><span class="s2">&quot;y&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">Xy_df</span>

<span class="n">Xy_train_df</span> <span class="o">=</span> <span class="n">to_Xy_df</span><span class="p">(</span><span class="n">X_trains</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y_trains</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> 
<span class="n">Xy_test_df</span> <span class="o">=</span> <span class="n">to_Xy_df</span><span class="p">(</span><span class="n">X_tests</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y_tests</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Xy_train_df.to_csv(&quot;data/Xy_train.csv&quot;,index=False)</span>
<span class="c1"># Xy_test_df.to_csv(&quot;data/Xy_test.csv&quot;,index=False)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ploting-the-datasets">
<h2>Ploting the datasets<a class="headerlink" href="#ploting-the-datasets" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_plotly</span><span class="p">(</span><span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span><span class="n">x_datasets</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span><span class="n">y_datasets_w_noise</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span><span class="n">true_f_x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span><span class="n">true_f_y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the function and the data coming from it for specific dataset i in x_datasets (using plotly).</span>
<span class="sd">    i: index to indicate which dataset to plot from x_datasets.</span>
<span class="sd">    x_datasets: input features of the d datatsets.</span>
<span class="sd">    y_datasets_w_noise: targets of the d datasets.</span>
<span class="sd">    true_f_x: x coordinates of the points from the true function.</span>
<span class="sd">    true_f_y: y cordinates of the points from the true function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span>
        <span class="n">layout</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
          <span class="n">title</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">Title</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Samples and True Function. Dataset </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
          <span class="n">xaxis_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
          <span class="n">yaxis_range</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span>
          <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
          <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
          <span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_datasets</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="n">y</span><span class="o">=</span><span class="n">y_datasets_w_noise</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;samples&#39;</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">true_f_x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">true_f_y</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;true function&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">fig</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#interact(lambda i : f_plotly(i,X_trains,y_trains,true_f_x,true_f_y), i=widgets.IntSlider(min=0, max=d-1, step=1, value=0));</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p id="bibtex-bibliography-001_dataset-regression-0"><dl class="citation">
<dt class="bibtex label" id="bishop-pattern-2007"><span class="brackets"><a class="fn-backref" href="#id2">Bis07</a></span></dt>
<dd><p>Christopher Bishop. <em>Pattern Recognition and Machine Learning</em>. Springer, 2007. ISBN 978-0387310732.</p>
</dd>
<dt class="bibtex label" id="casella-statistical-2001"><span class="brackets"><a class="fn-backref" href="#id1">CB01</a></span></dt>
<dd><p>George Casella and Roger Berger. <em>Statistical Inference</em>. Duxbury Resource Center, June 2001. ISBN 0534243126.</p>
</dd>
</dl>
</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">Welcome to another machine learning student (note)book</a>
    <a class='right-next' id="next-link" href="003_bias-vs-variance%28theory%29.html" title="next page">Bias-Variance trade-off (theory)</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By AnotherMLStudent<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'G-ZJ79CQ4Z6Z', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>