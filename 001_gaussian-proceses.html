
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Great Tutorial of Gaussian Processes &#8212; amls</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "github-org/github-repo");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://anothermlstudent.github.io/amls-book/001_gaussian-proceses.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Markdown Files" href="markdown.html" />
    <link rel="prev" title="Content in Jupyter Book" href="content.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://anothermlstudent.github.io/amls-book/001_gaussian-proceses.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Great Tutorial of Gaussian Processes" />
<meta property="og:description" content="Great Tutorial of Gaussian Processes  import plotly.io as pio import plotly.express as px import plotly.offline as py  df = px.data.iris() fig = px.scatter(df, " />
<meta property="og:image"       content="https://anothermlstudent.github.io/amls-book/_static/logo.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">amls</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to your Jupyter Book
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="content.html">
   Content in Jupyter Book
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Great Tutorial of Gaussian Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#references">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#que-quiero-hacer">
   ¿Qué quiero hacer?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#exponential-quadratic-rbf-kernel">
   Exponential quadratic (RBF) Kernel
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="#application">
   Application
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="markdown.html">
     Markdown Files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="notebooks.html">
     Content with notebooks
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/001_gaussian-proceses.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/anothermlstudent/amls-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/anothermlstudent/amls-book/issues/new?title=Issue%20on%20page%20%2F001_gaussian-proceses.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/anothermlstudent/amls-book/edit/main/amls/001_gaussian-proceses.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/anothermlstudent/amls-book/main?urlpath=tree/amls/001_gaussian-proceses.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/anothermlstudent/amls-book/blob/main/amls/001_gaussian-proceses.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Great Tutorial of Gaussian Processes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-resources">
     Other resources
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#que-quiero-hacer">
   ¿Qué quiero hacer?
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exponential-quadratic-rbf-kernel">
   Exponential quadratic (RBF) Kernel
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#xponentiated-quadratic-kernel">
     xponentiated Quadratic Kernel

$
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#application">
   Application
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="great-tutorial-of-gaussian-processes">
<h1>Great Tutorial of Gaussian Processes<a class="headerlink" href="#great-tutorial-of-gaussian-processes" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.io</span> <span class="k">as</span> <span class="nn">pio</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.offline</span> <span class="k">as</span> <span class="nn">py</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iris</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;sepal_width&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;sepal_length&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;sepal_length&quot;</span><span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">42</span><span class="n">caf4220f91</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">plotly.io</span> <span class="k">as</span> <span class="nn">pio</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">plotly.offline</span> <span class="k">as</span> <span class="nn">py</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> 
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">df</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iris</span><span class="p">()</span>

<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">hostedtoolcache</span><span class="o">/</span><span class="n">Python</span><span class="o">/</span><span class="mf">3.7</span><span class="o">.</span><span class="mi">9</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">plotly</span><span class="o">/</span><span class="n">express</span><span class="o">/</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>     <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>         <span class="sd">&quot;&quot;&quot;\</span>
<span class="ne">---&gt; </span><span class="mi">12</span><span class="sd"> Plotly express requires pandas to be installed.&quot;&quot;&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span>     <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> 

<span class="ne">ImportError</span>: Plotly express requires pandas to be installed.
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://www.youtube.com/watch?v=92-98SYOdlY">ML Tutorial: Gaussian Processes (Richard Turner)</a></p>
<p>At 40:32 (from the video), there is an equation for <span class="math notranslate nohighlight">\(p(y_1|y_2)\)</span>. For a detailed explanation see [1] Pag.111, the proof can be found in [1] Section 4.3.4.</p>
<p><a class="reference external" href="https://peterroelants.github.io/posts/gaussian-process-tutorial/">Great Notebook that already implemented most of the ideas I had</a></p>
<p><a class="reference external" href="http://www.tmpl.fi/gp/">Amazing Demo of GPs that implements the app I was thinking of</a></p>
<div class="section" id="other-resources">
<h2>Other resources<a class="headerlink" href="#other-resources" title="Permalink to this headline">¶</a></h2>
<p>Slide Deck
http://learning.eng.cam.ac.uk/pub/Public/Turner/Presentations/gp-approximation.pdf</p>
<p>another Richard Turner Presentation
https://www.youtube.com/watch?v=sQmsQq_Jfi8</p>
<p>Richard Turner website
http://cbl.eng.cam.ac.uk/Public/Turner/Teaching</p>
<p>Courses from Cambridge
https://github.com/baegwangbin/MLMI</p>
<p>Camdrige Master
MPhil in Machine Learning and Machine Intelligence
Core Courses
https://www.mlmi.eng.cam.ac.uk/core-modules</p>
<p><a class="reference external" href="http://inverseprobability.com/talks/notes/introduction-to-deep-gps.html">Application Example Neil Lawrence</a></p>
<p>http://www.gaussianprocess.org/gpml/code/matlab/doc/</p>
</div>
</div>
<div class="section" id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<p>[1] Murphy, K. P. (2012). Machine learning: A probabilistic perspective. Cambridge, Mass: MIT Press.</p>
<p>[2] <a class="reference external" href="http://www.gaussianprocess.org/gpml/chapters/RW.pdf">Gaussian Processes for Machine Learning</a></p>
</div>
<div class="section" id="que-quiero-hacer">
<h1>¿Qué quiero hacer?<a class="headerlink" href="#que-quiero-hacer" title="Permalink to this headline">¶</a></h1>
<p>Veo que hay una muy buena oportunidad para:</p>
<ul class="simple">
<li><p>crear un tutorial en el que finalmente puedo mostrar la conexión entre funciones y vectores.</p></li>
<li><p>usar dash para generar aplicaciones donde se pueda interactuar con las funciones a través de los distintos hiper-parametros (kernel, l, <span class="math notranslate nohighlight">\(\sigma\)</span>)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Installing scipy</span>
<span class="o">!</span>pip install scipy --upgrade
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting scipy
?25l  Downloading https://files.pythonhosted.org/packages/c8/89/63171228d5ced148f5ced50305c89e8576ffc695a90b58fe5bb602b910c2/scipy-1.5.4-cp36-cp36m-manylinux1_x86_64.whl (25.9MB)
     |████████████████████████████████| 25.9MB 172kB/s 
?25hRequirement already satisfied, skipping upgrade: numpy&gt;=1.14.5 in /usr/local/lib/python3.6/dist-packages (from scipy) (1.19.4)
<span class=" -Color -Color-Red">ERROR: albumentations 0.1.12 has requirement imgaug&lt;0.2.7,&gt;=0.2.5, but you&#39;ll have imgaug 0.2.9 which is incompatible.</span>
Installing collected packages: scipy
  Found existing installation: scipy 1.4.1
    Uninstalling scipy-1.4.1:
      Successfully uninstalled scipy-1.4.1
Successfully installed scipy-1.5.4
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">plotly</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Create  a grid of N points between 0 and 1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

<span class="c1"># Sample N independendent samples from a Normal(mu=0, sigma=1)</span>
<span class="c1"># Each sample is independent of each other </span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;N i.i.d samples from univariate normal&#39;</span><span class="p">)</span>

<span class="c1"># Sample N samples where  y_i ~ Normal(mu=y_{i-1}, sigma=1)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mu = y_{i-1}$&#39;</span><span class="p">)</span>

<span class="c1"># Sample 1 sample from an N-dimensional gaussian</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;1 sample from N-dimensional gaussian&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f02b8244eb8&gt;
</pre></div>
</div>
<img alt="_images/001_gaussian-proceses_9_1.png" src="_images/001_gaussian-proceses_9_1.png" />
</div>
</div>
</div>
<div class="section" id="exponential-quadratic-rbf-kernel">
<h1>Exponential quadratic (RBF) Kernel<a class="headerlink" href="#exponential-quadratic-rbf-kernel" title="Permalink to this headline">¶</a></h1>
<p>Q2 - ¿how can we express the way two points <span class="math notranslate nohighlight">\((x_i,y_i)\)</span> are related? ¿What kind of relationship we can describe?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">20</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

<span class="c1"># l is a parameter that regulates how fast neighbouring </span>
<span class="c1"># points will become uncorrelated (smaller l, faster they become uncorrelated)</span>
<span class="n">l</span> <span class="o">=</span> <span class="mi">4</span>
<span class="c1"># we can add an scaling factor s to regulate between which values it will vary </span>
<span class="n">s</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">k</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">xp</span> <span class="p">:</span> <span class="n">s</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">xp</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">l</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">k</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">),(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">),(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample 1 sample from an N-dimensional gaussian</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">S</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;with RBF Kernel&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f02b6319cc0&gt;
</pre></div>
</div>
<img alt="_images/001_gaussian-proceses_14_1.png" src="_images/001_gaussian-proceses_14_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7f02b5dc4748&gt;
</pre></div>
</div>
<img alt="_images/001_gaussian-proceses_15_1.png" src="_images/001_gaussian-proceses_15_1.png" />
</div>
</div>
<p><a class="reference external" href="https://peterroelants.github.io/posts/gaussian-process-tutorial/">Code From</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># code from https://peterroelants.github.io/posts/gaussian-process-tutorial/</span>
</pre></div>
</div>
</div>
</div>
<p>From https://www.cs.toronto.edu/~duvenaud/cookbook/

#</p>
<div class="section" id="xponentiated-quadratic-kernel">
<h2>xponentiated Quadratic Kernel

$<a class="headerlink" href="#xponentiated-quadratic-kernel" title="Permalink to this headline">¶</a></h2>
<p>{\displaystyle K(\mathbf {x} ,\mathbf {x’} )= \sigma^2 \exp \left(-{\frac {|\mathbf {x} -\mathbf {x’} |_{2}^{2}}{2 l ^{2}}}\right)}$$

Neil Lawrence says that this kernel should be called the “Exponentiated Quadratic”. The SE kernel has become the de-facto default kernel for GPs and SVMs. This is probably because it has some nice properties. It is universal, and you can integrate it against most functions that you need to. Every function in its prior has infinitely many derivatives. It also has only two parameters:
- The</p>
<ul class="simple">
<li><p>gthscale <span class="math notranslate nohighlight">\(l\)</span> determines the length of the ‘wiggles’ in your function. In general, you won’t be able to extrapolate more than ℓ units away from your data.
- The o</p></li>
<li><p>ut variance <span class="math notranslate nohighlight">\(\sigma^2\)</span> determines the average distance of your function away from its mean. Every kernel has this parameter out in front; it’s just a scale factor.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">spatial</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="k">def</span> <span class="nf">exponentiated_quadratic</span><span class="p">(</span><span class="n">X</span><span class="p">:</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">Xp</span><span class="p">:</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">sigma_f</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the Gram matrix Kij = k(xi,xj).</span>

<span class="sd">    Args:</span>
<span class="sd">        X (numpy.array): An (m,n) array representing m observations in an n-dimensional space. Inputs are converted to float.  </span>
<span class="sd">        Xp (numpy.array): An (m,n) array representing m observations in an n-dimensional space. Inputs are converted to float.  </span>
<span class="sd">        sigma_f (float, optional):  The output standard deviation determines the average distance of your function away from its mean. Defaults to 1.</span>
<span class="sd">        l (float, optional): The lengthscale determines the length of the &#39;wiggles&#39; in the function. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        numpy.array: Gram matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sq_norm</span> <span class="o">=</span> <span class="n">spatial</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Xp</span><span class="p">,</span> <span class="s1">&#39;sqeuclidean&#39;</span><span class="p">)</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">sigma_f</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="o">-</span><span class="n">sq_norm</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">K</span>
</pre></div>
</div>
</div>
</div>
<p>\begin{equation}
p(\theta|\cal{D}) = \frac{p(\cal{D}|\theta)p(\theta)}{p(\cal{D})}
\end{equation}

\begin{equation}
p(f|x_{1}, y_{1}) = \frac{p(x_{1}, y_{1}|f)p(f)}{p(x_{1}, y_{1})}
\end{equation}

and then

\begin{equation}
p(y_{2}| x_{1}, y_{1}, x_{2}) = \int p(y_{2} | f,x_{2})p(f|\cal{x_{1}, y_{1}}) , df
\end{equation}</p>
<p>\begin{equation}

p(y_{2}|x_{1}, y_{1}, x_{2}) = \cal{N}(y_{2}|\mu_{2|1},\Sigma_{2|1}) \

\mu_{2|1} = \mu_{2} + \Sigma_{21} \Sigma^{-1}<em>{11} (y</em>{1} - \mu_{1}) \

\Sigma_{2|1} = \Sigma_{22} - \Sigma_{21} \Sigma^{-1}<em>{11} \Sigma</em>{12}

\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gaussian process posterior</span>
<span class="k">def</span> <span class="nf">GP</span><span class="p">(</span><span class="n">X1</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">Y1</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">X2</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">kernel_func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the mean and covariance matrices of the mutlivariate gaussian of the posterior </span>
<span class="sd">    $p(Y_2|X1, Y1, X2)$. It assummes mu_1 and mu_2 = 0.</span>

<span class="sd">    Args:</span>
<span class="sd">        X1 (np.array): An (m1 x n_x) matrix with m1 training x observations of n_x-dimensions.</span>
<span class="sd">        Y1 (np.array): An (m1 x n_y) matrix with m1 training y observations of n_y-dimensions.</span>
<span class="sd">        X2 (np.array): An (m2 x n_x) matrix with m2 test x observations of n_x-dimensions.</span>
<span class="sd">        kernel_func ([type]): Function that computes the Gram matrix for a specific kernel</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.array ,np.array: mean and covariance matrices</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Kernel of the observations</span>
    <span class="n">K11</span> <span class="o">=</span> <span class="n">kernel_func</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X1</span><span class="p">)</span>
    <span class="c1"># Kernel of observations vs to-predict</span>
    <span class="n">K12</span> <span class="o">=</span> <span class="n">kernel_func</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">)</span>
    <span class="c1"># Solve A @ X = B -&gt; K11 @ X = K12 -&gt; X = inv(K11) @ K12 = (K21 @ inv(K11)).T  </span>
    <span class="n">K21invK11</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">K11</span><span class="p">,</span> <span class="n">K12</span><span class="p">,</span> <span class="n">assume_a</span><span class="o">=</span><span class="s1">&#39;pos&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="c1"># Compute posterior mean</span>
    <span class="n">mu2</span> <span class="o">=</span> <span class="n">K21invK11</span> <span class="o">@</span> <span class="n">Y1</span>
    
    <span class="n">K22</span> <span class="o">=</span> <span class="n">kernel_func</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">X2</span><span class="p">)</span>
    <span class="c1"># Compute the posterior covariance</span>
    <span class="n">S2</span> <span class="o">=</span> <span class="n">K22</span> <span class="o">-</span> <span class="p">(</span><span class="n">K21invK11</span> <span class="o">@</span> <span class="n">K12</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">S2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the posterior mean and covariance</span>

<span class="c1"># Define the true function that we want to regress on</span>
<span class="n">f_sin</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.48</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="mf">1.2</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">n1</span> <span class="o">=</span> <span class="mi">8</span>  <span class="c1"># Number of points to condition on (training points)</span>
<span class="n">n2</span> <span class="o">=</span> <span class="mi">75</span>  <span class="c1"># Number of points in posterior (test points)</span>
<span class="n">ny</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Number of functions that will be sampled from the posterior</span>
<span class="n">domain</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample observations (X1, y1) on the function</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">domain</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">domain</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">f_sin</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span>
<span class="c1"># Predict points at uniform spacing to capture function</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">domain</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">domain</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute posterior mean and covariance</span>
<span class="n">mu2</span><span class="p">,</span> <span class="n">S2</span> <span class="o">=</span> <span class="n">GP</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">exponentiated_quadratic</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the standard deviation at the test points to be plotted</span>
<span class="n">sigma2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">S2</span><span class="p">))</span>

<span class="c1"># Draw some samples of the posterior</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">mu2</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="n">S2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">ny</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">([</span>
                  <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;$\sin(x)$&#39;</span><span class="p">,</span>
                      <span class="n">x</span><span class="o">=</span><span class="n">X2</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> 
                      <span class="n">y</span><span class="o">=</span><span class="n">f_sin</span><span class="p">(</span><span class="n">X2</span><span class="p">),</span>
                      <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers+lines&#39;</span><span class="p">,</span>
                  <span class="p">),</span>
                  <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;$2 \sigma_{2|1}$&#39;</span><span class="p">,</span>
                      <span class="n">x</span><span class="o">=</span><span class="n">X2</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
                      <span class="n">y</span><span class="o">=</span><span class="n">mu2</span><span class="p">,</span>
                      <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                      <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(31, 119, 180)&#39;</span><span class="p">),</span>
                  <span class="p">),</span>
                  <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Upper Bound&#39;</span><span class="p">,</span>
                      <span class="n">x</span><span class="o">=</span><span class="n">X2</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
                      <span class="n">y</span><span class="o">=</span><span class="n">mu2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma2</span><span class="p">,</span>
                      <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                      <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#444&quot;</span><span class="p">),</span>
                      <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                      <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span>
                  <span class="p">),</span>
                  <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Lower Bound&#39;</span><span class="p">,</span>
                      <span class="n">x</span><span class="o">=</span><span class="n">X2</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
                      <span class="n">y</span><span class="o">=</span><span class="n">mu2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma2</span><span class="p">,</span>
                      <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#444&quot;</span><span class="p">),</span>
                      <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                      <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                      <span class="n">fillcolor</span><span class="o">=</span><span class="s1">&#39;rgba(68, 68, 68, 0.3)&#39;</span><span class="p">,</span>
                      <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;tonexty&#39;</span><span class="p">,</span>
                      <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span>
                  <span class="p">),</span>
                  <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;$(x_1, y_1)$&#39;</span><span class="p">,</span>
                        <span class="n">x</span><span class="o">=</span><span class="n">X1</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> 
                        <span class="n">y</span><span class="o">=</span><span class="n">y1</span><span class="p">,</span>
                        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                 
                <span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="2bc39ca6-9dc1-41c9-afa8-ff05767db9aa" class="plotly-graph-div" style="height:525px; width:100%;"></div>
            <script type="text/javascript">

                    window.PLOTLYENV=window.PLOTLYENV || {};

                if (document.getElementById("2bc39ca6-9dc1-41c9-afa8-ff05767db9aa")) {
                    Plotly.newPlot(
                        '2bc39ca6-9dc1-41c9-afa8-ff05767db9aa',
                        [{"mode": "markers+lines", "name": "$\\sin(x)$", "type": "scatter", "x": [-6.0, -5.837837837837838, -5.675675675675675, -5.513513513513513, -5.351351351351351, -5.1891891891891895, -5.027027027027027, -4.864864864864865, -4.702702702702703, -4.54054054054054, -4.378378378378378, -4.216216216216216, -4.054054054054054, -3.8918918918918917, -3.72972972972973, -3.5675675675675675, -3.4054054054054053, -3.243243243243243, -3.0810810810810807, -2.918918918918919, -2.7567567567567566, -2.5945945945945943, -2.4324324324324325, -2.27027027027027, -2.108108108108108, -1.9459459459459456, -1.7837837837837833, -1.621621621621621, -1.4594594594594597, -1.2972972972972974, -1.135135135135135, -0.9729729729729728, -0.8108108108108105, -0.6486486486486482, -0.48648648648648596, -0.3243243243243237, -0.1621621621621614, 0.0, 0.16216216216216228, 0.32432432432432456, 0.48648648648648685, 0.6486486486486491, 0.8108108108108114, 0.9729729729729737, 1.135135135135135, 1.2972972972972974, 1.4594594594594597, 1.621621621621622, 1.7837837837837842, 1.9459459459459465, 2.108108108108109, 2.27027027027027, 2.4324324324324333, 2.5945945945945947, 2.756756756756758, 2.9189189189189193, 3.0810810810810807, 3.243243243243244, 3.4054054054054053, 3.5675675675675684, 3.72972972972973, 3.891891891891893, 4.054054054054054, 4.216216216216218, 4.378378378378379, 4.54054054054054, 4.7027027027027035, 4.864864864864865, 5.027027027027028, 5.1891891891891895, 5.351351351351353, 5.513513513513514, 5.675675675675677, 5.837837837837839, 6.0], "y": [1.4575550006402087, 1.5732043020563147, 1.6499405308187147, 1.679762593615917, 1.6595610190674557, 1.5914421744734726, 1.482508640201254, 1.3441186415183108, 1.1907017550496282, 1.0382543731641247, 0.9026718004295455, 0.7980908902377921, 0.7354160307056672, 0.7211821715888305, 0.7568734415291665, 0.8387684016990977, 0.9583280708556265, 1.1030862634089655, 1.257949407197674, 1.4067703122444981, 1.5340317975883166, 1.6264646286626545, 1.674431066965128, 1.6729297727782702, 1.622117282265909, 1.5272916858416021, 1.398340209624553, 1.248708299273315, 1.0939976972295715, 0.9503396883270055, 0.8327131313486249, 0.7533826511459791, 0.7206198370945653, 0.737840785301792, 0.8032499108693572, 0.910027169008383, 1.0470391639331464, 1.2, 1.3529608360668544, 1.4899728309916176, 1.5967500891306432, 1.662159214698208, 1.6793801629054346, 1.6466173488540206, 1.567286868651375, 1.4496603116729943, 1.3060023027704284, 1.151291700726684, 1.001659790375446, 0.872708314158397, 0.7778827177340906, 0.7270702272217298, 0.7255689330348722, 0.7735353713373456, 0.8659682024116842, 0.993229687755502, 1.142050592802326, 1.296913736591035, 1.4416719291443734, 1.5612315983009029, 1.6431265584708334, 1.6788178284111694, 1.6645839692943327, 1.601909109762207, 1.4973281995704537, 1.3617456268358752, 1.2092982449503709, 1.055881358481689, 0.9174913597987453, 0.8085578255265273, 0.7404389809325437, 0.7202374063840828, 0.7500594691812859, 0.8267956979436857, 0.9424449993597912]}, {"line": {"color": "rgb(31, 119, 180)"}, "mode": "lines", "name": "$2 \\sigma_{2|1}$", "type": "scatter", "x": [-6.0, -5.837837837837838, -5.675675675675675, -5.513513513513513, -5.351351351351351, -5.1891891891891895, -5.027027027027027, -4.864864864864865, -4.702702702702703, -4.54054054054054, -4.378378378378378, -4.216216216216216, -4.054054054054054, -3.8918918918918917, -3.72972972972973, -3.5675675675675675, -3.4054054054054053, -3.243243243243243, -3.0810810810810807, -2.918918918918919, -2.7567567567567566, -2.5945945945945943, -2.4324324324324325, -2.27027027027027, -2.108108108108108, -1.9459459459459456, -1.7837837837837833, -1.621621621621621, -1.4594594594594597, -1.2972972972972974, -1.135135135135135, -0.9729729729729728, -0.8108108108108105, -0.6486486486486482, -0.48648648648648596, -0.3243243243243237, -0.1621621621621614, 0.0, 0.16216216216216228, 0.32432432432432456, 0.48648648648648685, 0.6486486486486491, 0.8108108108108114, 0.9729729729729737, 1.135135135135135, 1.2972972972972974, 1.4594594594594597, 1.621621621621622, 1.7837837837837842, 1.9459459459459465, 2.108108108108109, 2.27027027027027, 2.4324324324324333, 2.5945945945945947, 2.756756756756758, 2.9189189189189193, 3.0810810810810807, 3.243243243243244, 3.4054054054054053, 3.5675675675675684, 3.72972972972973, 3.891891891891893, 4.054054054054054, 4.216216216216218, 4.378378378378379, 4.54054054054054, 4.7027027027027035, 4.864864864864865, 5.027027027027028, 5.1891891891891895, 5.351351351351353, 5.513513513513514, 5.675675675675677, 5.837837837837839, 6.0], "y": [0.23811375338388885, 0.3082261332476113, 0.3862295532751967, 0.46826871920716684, 0.5490858679149206, 0.6225766841956468, 0.6827210277861244, 0.724785490246759, 0.7465848152223498, 0.7495062865418107, 0.7389806115094826, 0.7241491873104319, 0.7166327146478251, 0.728522322557787, 0.7699378194048835, 0.8466619372473013, 0.9584064350681283, 1.0981672381667296, 1.25289585690166, 1.4054096911359686, 1.537167331733657, 1.6313298461321097, 1.6754720307850612, 1.6634109945042934, 1.5958482849204545, 1.4798070974026913, 1.3271083370627803, 1.1523031979124463, 0.9705322569500447, 0.7957160191302064, 0.6393339862999294, 0.5098687670871827, 0.4128276009822551, 0.35114153145351956, 0.32569880093315207, 0.3357922061005909, 0.3793354307627639, 0.45280892017803875, 0.5510072814860401, 0.66675328771578, 0.7907962486404605, 0.9121075299393109, 1.018715208124652, 1.0990893342954369, 1.143922900227837, 1.1479918469024906, 1.1116696310740783, 1.041662124112178, 0.9506396636688184, 0.85566364072145, 0.7755871644598437, 0.7278788889003769, 0.7254970277820557, 0.7744690672825627, 0.8726956957307764, 1.0102281208610557, 1.1709389138553954, 1.3352068037568743, 1.4830424336478925, 1.5970369161935407, 1.6646151101533537, 1.6792786502934955, 1.6407659454018582, 1.5542737389823706, 1.429031680352439, 1.2765791351836366, 1.1090697356633923, 0.937849120290343, 0.7724464553026236, 0.6200186831518346, 0.4852067417446313, 0.37031332700711417, 0.2756914597737943, 0.20023610324349472, 0.14188921029345658]}, {"line": {"width": 0}, "marker": {"color": "#444"}, "mode": "lines", "name": "Upper Bound", "showlegend": false, "type": "scatter", "x": [-6.0, -5.837837837837838, -5.675675675675675, -5.513513513513513, -5.351351351351351, -5.1891891891891895, -5.027027027027027, -4.864864864864865, -4.702702702702703, -4.54054054054054, -4.378378378378378, -4.216216216216216, -4.054054054054054, -3.8918918918918917, -3.72972972972973, -3.5675675675675675, -3.4054054054054053, -3.243243243243243, -3.0810810810810807, -2.918918918918919, -2.7567567567567566, -2.5945945945945943, -2.4324324324324325, -2.27027027027027, -2.108108108108108, -1.9459459459459456, -1.7837837837837833, -1.621621621621621, -1.4594594594594597, -1.2972972972972974, -1.135135135135135, -0.9729729729729728, -0.8108108108108105, -0.6486486486486482, -0.48648648648648596, -0.3243243243243237, -0.1621621621621614, 0.0, 0.16216216216216228, 0.32432432432432456, 0.48648648648648685, 0.6486486486486491, 0.8108108108108114, 0.9729729729729737, 1.135135135135135, 1.2972972972972974, 1.4594594594594597, 1.621621621621622, 1.7837837837837842, 1.9459459459459465, 2.108108108108109, 2.27027027027027, 2.4324324324324333, 2.5945945945945947, 2.756756756756758, 2.9189189189189193, 3.0810810810810807, 3.243243243243244, 3.4054054054054053, 3.5675675675675684, 3.72972972972973, 3.891891891891893, 4.054054054054054, 4.216216216216218, 4.378378378378379, 4.54054054054054, 4.7027027027027035, 4.864864864864865, 5.027027027027028, 5.1891891891891895, 5.351351351351353, 5.513513513513514, 5.675675675675677, 5.837837837837839, 6.0], "y": [2.1644646295268677, 2.182099073353681, 2.1818014067587574, 2.1541006127630733, 2.0903517266745553, 1.98479802148282, 1.8366043903768854, 1.6513429904154757, 1.4414330938222015, 1.2252009250700153, 1.0245187571006737, 0.8613478028862955, 0.7538499027877492, 0.7441062330772276, 0.7997528394821741, 0.8660853374672501, 0.958614993625953, 1.1123727888478558, 1.2687868272693197, 1.4100856987306842, 1.548990218021942, 1.6515359727364705, 1.680250891923039, 1.7118353361260068, 1.7439790530378068, 1.775499488916945, 1.8118616992952916, 1.8549534594129926, 1.9035719490886205, 1.954715569011999, 2.0051639561631327, 2.052825555563797, 2.0974618667472797, 2.140603531619285, 2.1846992912668, 2.2317427694337555, 2.2817717148584253, 2.3316949314131583, 2.3748434376357457, 2.4014689737128734, 2.4001788344355215, 2.3600727139027384, 2.273179288814875, 2.136691177644688, 1.9544782690873403, 1.7374444641456988, 1.5024976145824238, 1.2702071750064214, 1.0615621089427891, 0.8945138788804882, 0.7810987882334476, 0.729933191245392, 0.7256911261871962, 0.7771587814330029, 0.8934715518787998, 1.0667800510917227, 1.2750399688009328, 1.4855940682985522, 1.661348490558771, 1.7677363446446086, 1.7789302899571737, 1.6820397385010952, 1.8029409956979061, 1.9252847098119297, 2.037610961579628, 2.1335317964666722, 2.2076169796677787, 2.2565855285168674, 2.279971167358946, 2.2801340502382086, 2.261679728871174, 2.230489993278682, 2.192639403700679, 2.153459737298493, 2.1169352776541492]}, {"fill": "tonexty", "fillcolor": "rgba(68, 68, 68, 0.3)", "line": {"width": 0}, "marker": {"color": "#444"}, "mode": "lines", "name": "Lower Bound", "showlegend": false, "type": "scatter", "x": [-6.0, -5.837837837837838, -5.675675675675675, -5.513513513513513, -5.351351351351351, -5.1891891891891895, -5.027027027027027, -4.864864864864865, -4.702702702702703, -4.54054054054054, -4.378378378378378, -4.216216216216216, -4.054054054054054, -3.8918918918918917, -3.72972972972973, -3.5675675675675675, -3.4054054054054053, -3.243243243243243, -3.0810810810810807, -2.918918918918919, -2.7567567567567566, -2.5945945945945943, -2.4324324324324325, -2.27027027027027, -2.108108108108108, -1.9459459459459456, -1.7837837837837833, -1.621621621621621, -1.4594594594594597, -1.2972972972972974, -1.135135135135135, -0.9729729729729728, -0.8108108108108105, -0.6486486486486482, -0.48648648648648596, -0.3243243243243237, -0.1621621621621614, 0.0, 0.16216216216216228, 0.32432432432432456, 0.48648648648648685, 0.6486486486486491, 0.8108108108108114, 0.9729729729729737, 1.135135135135135, 1.2972972972972974, 1.4594594594594597, 1.621621621621622, 1.7837837837837842, 1.9459459459459465, 2.108108108108109, 2.27027027027027, 2.4324324324324333, 2.5945945945945947, 2.756756756756758, 2.9189189189189193, 3.0810810810810807, 3.243243243243244, 3.4054054054054053, 3.5675675675675684, 3.72972972972973, 3.891891891891893, 4.054054054054054, 4.216216216216218, 4.378378378378379, 4.54054054054054, 4.7027027027027035, 4.864864864864865, 5.027027027027028, 5.1891891891891895, 5.351351351351353, 5.513513513513514, 5.675675675675677, 5.837837837837839, 6.0], "y": [-1.6882371227590898, -1.5656468068584584, -1.4093423002083643, -1.2175631743487396, -0.9921799908447138, -0.7396446530915264, -0.47116233480463654, -0.20177200992195776, 0.051736536622497886, 0.2738116480136062, 0.4534424659182914, 0.5869505717345682, 0.6794155265079009, 0.7129384120383465, 0.7401227993275928, 0.8272385370273525, 0.9581978765103035, 1.0839616874856033, 1.2370048865340002, 1.400733683541253, 1.525344445445372, 1.611123719527749, 1.6706931696470835, 1.61498665288258, 1.4477175168031022, 1.1841147058884376, 0.842354974830269, 0.44965293641189996, 0.03749256481146912, -0.36328353075158626, -0.7264959835632738, -1.0330880213894318, -1.2718066647827695, -1.4383204687122457, -1.533301689400496, -1.560158357232574, -1.5231008533328976, -1.4260770910570808, -1.2728288746636658, -1.0679623982813131, -0.8185863371546005, -0.5358576540241169, -0.23574887256557076, 0.06148749094618555, 0.33336753136833364, 0.5585392296592823, 0.7208416475657329, 0.8131170732179345, 0.8397172183948476, 0.8168134025624118, 0.7700755406862397, 0.7258245865553618, 0.7253029293769152, 0.7717793531321225, 0.8519198395827531, 0.9536761906303887, 1.066837858909858, 1.1848195392151963, 1.304736376737014, 1.4263374877424728, 1.5502999303495337, 1.6765175620858959, 1.4785908951058102, 1.1832627681528116, 0.8204523991252501, 0.41962647390060115, 0.01052249165900565, -0.38088728793618154, -0.7350782567536986, -1.0400966839345394, -1.2912662453819115, -1.4898633392644536, -1.6412564841530901, -1.7529875308115035, -1.8331568570672359]}, {"mode": "markers", "name": "$(x_1, y_1)$", "type": "scatter", "x": [-2.872606200201899, 2.4175758460323173, -3.4035948505618334, 3.8950954928041384, 2.1779581543732593, -2.4102745477266208, -3.955823063011181, 2.5236914276386733], "y": [1.4459502149126253, 0.7236124237823566, 0.9598314073677622, 1.6790237118939202, 0.7501758788322943, 1.6771950695646158, 0.7207978253606078, 0.7466820847865356]}],
                        {"showlegend": true, "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}},
                        {"responsive": true}
                    ).then(function(){

var gd = document.getElementById('2bc39ca6-9dc1-41c9-afa8-ff05767db9aa');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };

            </script>
        </div>
</body>
</html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gaussian process posterior</span>
<span class="k">def</span> <span class="nf">GP_noise</span><span class="p">(</span><span class="n">X1</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">Y1</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">X2</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">kernel_func</span><span class="p">,</span><span class="n">sigma_y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the mean and covariance matrices of the mutlivariate gaussian of the posterior </span>
<span class="sd">    $p(Y_2|X1, Y1, X2)$. It assummes mu_1 and mu_2 = 0.</span>

<span class="sd">    Args:</span>
<span class="sd">        X1 (np.array): An (m1 x n_x) matrix with m1 training x observations of n_x-dimensions.</span>
<span class="sd">        Y1 (np.array): An (m1 x n_y) matrix with m1 training y observations of n_y-dimensions.</span>
<span class="sd">        X2 (np.array): An (m2 x n_x) matrix with m2 test x observations of n_x-dimensions.</span>
<span class="sd">        kernel_func ([type]): Function that computes the Gram matrix for a specific kernel</span>
<span class="sd">        sigma_y (float): noise in the y observations</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.array ,np.array: mean and covariance matrices</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Kernel of the observations</span>
    <span class="n">K11</span> <span class="o">=</span> <span class="n">kernel_func</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X1</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">sigma_y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">X1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="c1"># Kernel of observations vs to-predict</span>
    <span class="n">K12</span> <span class="o">=</span> <span class="n">kernel_func</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">)</span>
    <span class="c1"># Solve A @ X = B -&gt; K11 @ X = K12 -&gt; X = inv(K11) @ K12 = (K21 @ inv(K11)).T  </span>
    <span class="n">K21invK11</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">K11</span><span class="p">,</span> <span class="n">K12</span><span class="p">,</span> <span class="n">assume_a</span><span class="o">=</span><span class="s1">&#39;pos&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="c1"># Compute posterior mean</span>
    <span class="n">mu_2</span> <span class="o">=</span> <span class="n">K21invK11</span> <span class="o">@</span> <span class="n">Y1</span>
    
    <span class="n">K22</span> <span class="o">=</span> <span class="n">kernel_func</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">X2</span><span class="p">)</span>
    <span class="c1"># Compute the posterior covariance</span>
    <span class="n">S_2</span> <span class="o">=</span> <span class="n">K22</span> <span class="o">-</span> <span class="p">(</span><span class="n">K21invK11</span> <span class="o">@</span> <span class="n">K12</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mu_2</span><span class="p">,</span> <span class="n">S_2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the posterior mean and covariance</span>
<span class="n">sigma_y</span> <span class="o">=</span> <span class="mf">1.</span>  <span class="c1"># The standard deviation of the noise</span>

<span class="c1"># Add noise kernel to the samples we sampled previously</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="p">((</span><span class="n">sigma_y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n1</span><span class="p">))</span>

<span class="c1"># Compute posterior mean and covariance</span>
<span class="n">mu2</span><span class="p">,</span> <span class="n">S2</span> <span class="o">=</span> <span class="n">GP_noise</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">exponentiated_quadratic</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">)</span>
<span class="c1"># Compute the standard deviation at the test points to be plotted</span>
<span class="n">sigma2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">S2</span><span class="p">))</span>

<span class="c1"># Draw some samples of the posterior</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">mu2</span><span class="p">,</span> <span class="n">cov</span><span class="o">=</span><span class="n">S2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">ny</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">([</span>
                  <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;$\sin(x)$&#39;</span><span class="p">,</span>
                      <span class="n">x</span><span class="o">=</span><span class="n">X2</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> 
                      <span class="n">y</span><span class="o">=</span><span class="n">f_sin</span><span class="p">(</span><span class="n">X2</span><span class="p">),</span>
                      <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers+lines&#39;</span><span class="p">,</span>
                  <span class="p">),</span>
                  <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;$2 \sigma_{2|1}$&#39;</span><span class="p">,</span>
                      <span class="n">x</span><span class="o">=</span><span class="n">X2</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
                      <span class="n">y</span><span class="o">=</span><span class="n">mu2</span><span class="p">,</span>
                      <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                      <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;rgb(31, 119, 180)&#39;</span><span class="p">),</span>
                  <span class="p">),</span>
                  <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Upper Bound&#39;</span><span class="p">,</span>
                      <span class="n">x</span><span class="o">=</span><span class="n">X2</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
                      <span class="n">y</span><span class="o">=</span><span class="n">mu2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma2</span><span class="p">,</span>
                      <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                      <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#444&quot;</span><span class="p">),</span>
                      <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                      <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span>
                  <span class="p">),</span>
                  <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                      <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Lower Bound&#39;</span><span class="p">,</span>
                      <span class="n">x</span><span class="o">=</span><span class="n">X2</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
                      <span class="n">y</span><span class="o">=</span><span class="n">mu2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma2</span><span class="p">,</span>
                      <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#444&quot;</span><span class="p">),</span>
                      <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                      <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
                      <span class="n">fillcolor</span><span class="o">=</span><span class="s1">&#39;rgba(68, 68, 68, 0.3)&#39;</span><span class="p">,</span>
                      <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;tonexty&#39;</span><span class="p">,</span>
                      <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span>
                  <span class="p">),</span>
                  <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;$(x_1, y_1)$&#39;</span><span class="p">,</span>
                        <span class="n">x</span><span class="o">=</span><span class="n">X1</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> 
                        <span class="n">y</span><span class="o">=</span><span class="n">y1</span><span class="p">,</span>
                        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                 
                <span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax) {MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>
                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>    
            <div id="74fd6aea-4af0-4f0f-acf7-994ab576dde5" class="plotly-graph-div" style="height:525px; width:100%;"></div>
            <script type="text/javascript">

                    window.PLOTLYENV=window.PLOTLYENV || {};

                if (document.getElementById("74fd6aea-4af0-4f0f-acf7-994ab576dde5")) {
                    Plotly.newPlot(
                        '74fd6aea-4af0-4f0f-acf7-994ab576dde5',
                        [{"mode": "markers+lines", "name": "$\\sin(x)$", "type": "scatter", "x": [-6.0, -5.837837837837838, -5.675675675675675, -5.513513513513513, -5.351351351351351, -5.1891891891891895, -5.027027027027027, -4.864864864864865, -4.702702702702703, -4.54054054054054, -4.378378378378378, -4.216216216216216, -4.054054054054054, -3.8918918918918917, -3.72972972972973, -3.5675675675675675, -3.4054054054054053, -3.243243243243243, -3.0810810810810807, -2.918918918918919, -2.7567567567567566, -2.5945945945945943, -2.4324324324324325, -2.27027027027027, -2.108108108108108, -1.9459459459459456, -1.7837837837837833, -1.621621621621621, -1.4594594594594597, -1.2972972972972974, -1.135135135135135, -0.9729729729729728, -0.8108108108108105, -0.6486486486486482, -0.48648648648648596, -0.3243243243243237, -0.1621621621621614, 0.0, 0.16216216216216228, 0.32432432432432456, 0.48648648648648685, 0.6486486486486491, 0.8108108108108114, 0.9729729729729737, 1.135135135135135, 1.2972972972972974, 1.4594594594594597, 1.621621621621622, 1.7837837837837842, 1.9459459459459465, 2.108108108108109, 2.27027027027027, 2.4324324324324333, 2.5945945945945947, 2.756756756756758, 2.9189189189189193, 3.0810810810810807, 3.243243243243244, 3.4054054054054053, 3.5675675675675684, 3.72972972972973, 3.891891891891893, 4.054054054054054, 4.216216216216218, 4.378378378378379, 4.54054054054054, 4.7027027027027035, 4.864864864864865, 5.027027027027028, 5.1891891891891895, 5.351351351351353, 5.513513513513514, 5.675675675675677, 5.837837837837839, 6.0], "y": [1.4575550006402087, 1.5732043020563147, 1.6499405308187147, 1.679762593615917, 1.6595610190674557, 1.5914421744734726, 1.482508640201254, 1.3441186415183108, 1.1907017550496282, 1.0382543731641247, 0.9026718004295455, 0.7980908902377921, 0.7354160307056672, 0.7211821715888305, 0.7568734415291665, 0.8387684016990977, 0.9583280708556265, 1.1030862634089655, 1.257949407197674, 1.4067703122444981, 1.5340317975883166, 1.6264646286626545, 1.674431066965128, 1.6729297727782702, 1.622117282265909, 1.5272916858416021, 1.398340209624553, 1.248708299273315, 1.0939976972295715, 0.9503396883270055, 0.8327131313486249, 0.7533826511459791, 0.7206198370945653, 0.737840785301792, 0.8032499108693572, 0.910027169008383, 1.0470391639331464, 1.2, 1.3529608360668544, 1.4899728309916176, 1.5967500891306432, 1.662159214698208, 1.6793801629054346, 1.6466173488540206, 1.567286868651375, 1.4496603116729943, 1.3060023027704284, 1.151291700726684, 1.001659790375446, 0.872708314158397, 0.7778827177340906, 0.7270702272217298, 0.7255689330348722, 0.7735353713373456, 0.8659682024116842, 0.993229687755502, 1.142050592802326, 1.296913736591035, 1.4416719291443734, 1.5612315983009029, 1.6431265584708334, 1.6788178284111694, 1.6645839692943327, 1.601909109762207, 1.4973281995704537, 1.3617456268358752, 1.2092982449503709, 1.055881358481689, 0.9174913597987453, 0.8085578255265273, 0.7404389809325437, 0.7202374063840828, 0.7500594691812859, 0.8267956979436857, 0.9424449993597912]}, {"line": {"color": "rgb(31, 119, 180)"}, "mode": "lines", "name": "$2 \\sigma_{2|1}$", "type": "scatter", "x": [-6.0, -5.837837837837838, -5.675675675675675, -5.513513513513513, -5.351351351351351, -5.1891891891891895, -5.027027027027027, -4.864864864864865, -4.702702702702703, -4.54054054054054, -4.378378378378378, -4.216216216216216, -4.054054054054054, -3.8918918918918917, -3.72972972972973, -3.5675675675675675, -3.4054054054054053, -3.243243243243243, -3.0810810810810807, -2.918918918918919, -2.7567567567567566, -2.5945945945945943, -2.4324324324324325, -2.27027027027027, -2.108108108108108, -1.9459459459459456, -1.7837837837837833, -1.621621621621621, -1.4594594594594597, -1.2972972972972974, -1.135135135135135, -0.9729729729729728, -0.8108108108108105, -0.6486486486486482, -0.48648648648648596, -0.3243243243243237, -0.1621621621621614, 0.0, 0.16216216216216228, 0.32432432432432456, 0.48648648648648685, 0.6486486486486491, 0.8108108108108114, 0.9729729729729737, 1.135135135135135, 1.2972972972972974, 1.4594594594594597, 1.621621621621622, 1.7837837837837842, 1.9459459459459465, 2.108108108108109, 2.27027027027027, 2.4324324324324333, 2.5945945945945947, 2.756756756756758, 2.9189189189189193, 3.0810810810810807, 3.243243243243244, 3.4054054054054053, 3.5675675675675684, 3.72972972972973, 3.891891891891893, 4.054054054054054, 4.216216216216218, 4.378378378378379, 4.54054054054054, 4.7027027027027035, 4.864864864864865, 5.027027027027028, 5.1891891891891895, 5.351351351351353, 5.513513513513514, 5.675675675675677, 5.837837837837839, 6.0], "y": [0.056683734672347955, 0.07232940459426089, 0.08878472930606798, 0.10453273385129964, 0.11757934903667404, 0.12564947568574852, 0.12653619949136097, 0.11858495647035336, 0.10125154963110339, 0.07563048457267683, 0.04482108231827431, 0.013996395635296865, -0.009926960938508957, -0.019050893074754376, -0.005628064453130903, 0.03659692240756454, 0.11107654689653013, 0.21745026024937178, 0.35107569845097464, 0.5032500368236708, 0.6621349482891515, 0.8142509328749113, 0.9462834563328988, 1.0468758667497144, 1.1080894687528866, 1.126287037973036, 1.102321687615152, 1.0410557459367065, 0.9503594526273805, 0.839819672088464, 0.7194114164987211, 0.5983526234782478, 0.4842910834087599, 0.38288411735580885, 0.29774876414191626, 0.23069922127950424, 0.18215687006022785, 0.151615746074267, 0.13806608391518496, 0.14031109384357465, 0.15714816751291727, 0.1874181509220357, 0.22995085789186046, 0.2834498065267765, 0.3463641499268548, 0.41679185599338636, 0.49244690679866515, 0.5707067492953505, 0.6487372227796022, 0.7236741353206102, 0.7928272339313043, 0.8538666828207733, 0.9049560633826768, 0.9448088551256015, 0.9726643990499038, 0.988199580833679, 0.9914082907186165, 0.9824874613778072, 0.9617639793235213, 0.9296821645629719, 0.8868510960309398, 0.8341309669134886, 0.7727239567089754, 0.7042318712236921, 0.630650815681891, 0.5542897776077397, 0.4776200881484069, 0.4030804514420654, 0.3328728446817604, 0.2687858089726969, 0.21207405669167992, 0.16340984513901816, 0.1229063105710836, 0.09019984648978997, 0.06457033226898587]}, {"line": {"width": 0}, "marker": {"color": "#444"}, "mode": "lines", "name": "Upper Bound", "showlegend": false, "type": "scatter", "x": [-6.0, -5.837837837837838, -5.675675675675675, -5.513513513513513, -5.351351351351351, -5.1891891891891895, -5.027027027027027, -4.864864864864865, -4.702702702702703, -4.54054054054054, -4.378378378378378, -4.216216216216216, -4.054054054054054, -3.8918918918918917, -3.72972972972973, -3.5675675675675675, -3.4054054054054053, -3.243243243243243, -3.0810810810810807, -2.918918918918919, -2.7567567567567566, -2.5945945945945943, -2.4324324324324325, -2.27027027027027, -2.108108108108108, -1.9459459459459456, -1.7837837837837833, -1.621621621621621, -1.4594594594594597, -1.2972972972972974, -1.135135135135135, -0.9729729729729728, -0.8108108108108105, -0.6486486486486482, -0.48648648648648596, -0.3243243243243237, -0.1621621621621614, 0.0, 0.16216216216216228, 0.32432432432432456, 0.48648648648648685, 0.6486486486486491, 0.8108108108108114, 0.9729729729729737, 1.135135135135135, 1.2972972972972974, 1.4594594594594597, 1.621621621621622, 1.7837837837837842, 1.9459459459459465, 2.108108108108109, 2.27027027027027, 2.4324324324324333, 2.5945945945945947, 2.756756756756758, 2.9189189189189193, 3.0810810810810807, 3.243243243243244, 3.4054054054054053, 3.5675675675675684, 3.72972972972973, 3.891891891891893, 4.054054054054054, 4.216216216216218, 4.378378378378379, 4.54054054054054, 4.7027027027027035, 4.864864864864865, 5.027027027027028, 5.1891891891891895, 5.351351351351353, 5.513513513513514, 5.675675675675677, 5.837837837837839, 6.0], "y": [2.0485408872403488, 2.0570422042085577, 2.0615070361304237, 2.0582284256085313, 2.0427161109951206, 2.010216915292229, 1.9565420082060356, 1.8791203620850898, 1.778108250187258, 1.657309666722111, 1.524617912461785, 1.391689540746684, 1.272641159145192, 1.1817904905361971, 1.1309125815878922, 1.1269902122199769, 1.1714641212264043, 1.2611784832927235, 1.3901867848680758, 1.5512507538591385, 1.736268490658781, 1.9356186683932872, 2.1373148406412583, 2.3272924461695244, 2.4913192391947163, 2.617653103729104, 2.699161158619432, 2.734215622258645, 2.726375734416965, 2.6832072508796765, 2.6146657670739075, 2.5314284296012417, 2.443469518977587, 2.359062319362064, 2.2842685077828815, 2.2228661486844974, 2.1765881443195716, 2.145508831879787, 2.1284302111059783, 2.1231712167159755, 2.1267345337562666, 2.1353937375840113, 2.1447903045328034, 2.1501448007469826, 2.1466700179398903, 2.1302371838281866, 2.0983059600274934, 2.0510955563473425, 1.9929291628655363, 1.9335102128390704, 1.8882413125000443, 1.875256692877869, 1.9067081521250495, 1.978817217288425, 2.072418746854831, 2.16399305140966, 2.2352177443901393, 2.2764408850979927, 2.286653104589494, 2.272083713925416, 2.2438011995800102, 2.2141926586184923, 2.1928841303265667, 2.1837967402514633, 2.1849684918834473, 2.1909069727804398, 2.195621020487583, 2.194743433805922, 2.186329780474484, 2.1706650984086577, 2.1495631937673667, 2.1255405001495675, 2.101104989633708, 2.078279394154212, 2.058382771205103]}, {"fill": "tonexty", "fillcolor": "rgba(68, 68, 68, 0.3)", "line": {"width": 0}, "marker": {"color": "#444"}, "mode": "lines", "name": "Lower Bound", "showlegend": false, "type": "scatter", "x": [-6.0, -5.837837837837838, -5.675675675675675, -5.513513513513513, -5.351351351351351, -5.1891891891891895, -5.027027027027027, -4.864864864864865, -4.702702702702703, -4.54054054054054, -4.378378378378378, -4.216216216216216, -4.054054054054054, -3.8918918918918917, -3.72972972972973, -3.5675675675675675, -3.4054054054054053, -3.243243243243243, -3.0810810810810807, -2.918918918918919, -2.7567567567567566, -2.5945945945945943, -2.4324324324324325, -2.27027027027027, -2.108108108108108, -1.9459459459459456, -1.7837837837837833, -1.621621621621621, -1.4594594594594597, -1.2972972972972974, -1.135135135135135, -0.9729729729729728, -0.8108108108108105, -0.6486486486486482, -0.48648648648648596, -0.3243243243243237, -0.1621621621621614, 0.0, 0.16216216216216228, 0.32432432432432456, 0.48648648648648685, 0.6486486486486491, 0.8108108108108114, 0.9729729729729737, 1.135135135135135, 1.2972972972972974, 1.4594594594594597, 1.621621621621622, 1.7837837837837842, 1.9459459459459465, 2.108108108108109, 2.27027027027027, 2.4324324324324333, 2.5945945945945947, 2.756756756756758, 2.9189189189189193, 3.0810810810810807, 3.243243243243244, 3.4054054054054053, 3.5675675675675684, 3.72972972972973, 3.891891891891893, 4.054054054054054, 4.216216216216218, 4.378378378378379, 4.54054054054054, 4.7027027027027035, 4.864864864864865, 5.027027027027028, 5.1891891891891895, 5.351351351351353, 5.513513513513514, 5.675675675675677, 5.837837837837839, 6.0], "y": [-1.935173417895653, -1.9123833950200357, -1.8839375775182878, -1.8491629579059319, -1.8075574129217726, -1.7589179639207317, -1.7034696092233137, -1.641950449144383, -1.5756051509250515, -1.5060486975767575, -1.434975747825236, -1.3636967494760903, -1.2924950810222098, -1.2198922766857059, -1.1421687104941538, -1.0537963674048476, -0.9493110274333442, -0.82627796279398, -0.6880353879661265, -0.544750680211797, -0.4119985940804779, -0.30711680264346464, -0.24474792797546074, -0.23354071267009568, -0.2751403016889431, -0.3650790277830318, -0.4945177833891279, -0.652104130385232, -0.8256568291622041, -1.0035679067027483, -1.1758429340764653, -1.3347231826447463, -1.4748873521600672, -1.5932940846504464, -1.688770979499049, -1.7614677061254889, -1.812274404199116, -1.8422773397312526, -1.8522980432756084, -1.842549029028826, -1.8124381987304323, -1.76055743573994, -1.6848885887490823, -1.5832451876934295, -1.4539417180861807, -1.296653471841414, -1.113412146430163, -0.9096820577566417, -0.6954547173063319, -0.48616194219785, -0.3025868446374358, -0.16752332723632235, -0.096796025359696, -0.08919950703722201, -0.12708994875502388, -0.18759388974230196, -0.25240116295290627, -0.31146596234237833, -0.3631251459424514, -0.412719384799472, -0.4700990075181307, -0.545930724791515, -0.6474362169086156, -0.775332997804079, -0.9236668605196655, -1.0823274175649606, -1.2403808441907689, -1.3885825309217914, -1.520584091110963, -1.6330934804632637, -1.725415080384007, -1.7987208098715313, -1.855292368491541, -1.8978797011746322, -1.929242106667131]}, {"mode": "markers", "name": "$(x_1, y_1)$", "type": "scatter", "x": [-2.872606200201899, 2.4175758460323173, -3.4035948505618334, 3.8950954928041384, 2.1779581543732593, -2.4102745477266208, -3.955823063011181, 2.5236914276386733], "y": [-0.31278927151048896, -0.4596460888834185, -1.0794007703923385, 1.4096168774493625, 1.4677181346282566, 3.179552121660644, 0.7948926057803829, 2.3752976303578275]}],
                        {"showlegend": true, "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}},
                        {"responsive": true}
                    ).then(function(){

var gd = document.getElementById('74fd6aea-4af0-4f0f-acf7-994ab576dde5');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };

            </script>
        </div>
</body>
</html></div></div>
</div>
</div>
</div>
<div class="section" id="application">
<h1>Application<a class="headerlink" href="#application" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://www.youtube.com/watch?v=vz3D36VXefI">Machine learning - Bayesian optimization and multi-armed bandits</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample observations (X1, y1) on the function</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">domain</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">domain</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">f_sin</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span>
<span class="c1"># Predict points at uniform spacing to capture function</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">domain</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">domain</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_train</span> <span class="o">=</span> <span class="n">X1</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">X2</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">y1</span>
<span class="n">y</span><span class="o">=</span><span class="n">f_sin</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.gaussian_process</span> <span class="kn">import</span> <span class="n">GaussianProcessRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.gaussian_process.kernels</span> <span class="kn">import</span> <span class="n">RBF</span><span class="p">,</span> <span class="n">ConstantKernel</span> <span class="k">as</span> <span class="n">C</span>


<span class="n">kernel</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">))</span> <span class="o">*</span> <span class="n">RBF</span><span class="p">(</span><span class="mf">0.004</span><span class="p">)</span>
<span class="n">gp</span> <span class="o">=</span> <span class="n">GaussianProcessRegressor</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_restarts_optimizer</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">gp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GaussianProcessRegressor(alpha=1e-10, copy_X_train=True,
                         kernel=1**2 * RBF(length_scale=0.004),
                         n_restarts_optimizer=10, normalize_y=False,
                         optimizer=&#39;fmin_l_bfgs_b&#39;, random_state=0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;alpha&#39;: 1e-10,
 &#39;copy_X_train&#39;: True,
 &#39;kernel&#39;: 1**2 * RBF(length_scale=0.004),
 &#39;kernel__k1&#39;: 1**2,
 &#39;kernel__k1__constant_value&#39;: 1.0,
 &#39;kernel__k1__constant_value_bounds&#39;: (0.001, 1000.0),
 &#39;kernel__k2&#39;: RBF(length_scale=0.004),
 &#39;kernel__k2__length_scale&#39;: 0.004,
 &#39;kernel__k2__length_scale_bounds&#39;: (1e-05, 100000.0),
 &#39;n_restarts_optimizer&#39;: 10,
 &#39;normalize_y&#39;: False,
 &#39;optimizer&#39;: &#39;fmin_l_bfgs_b&#39;,
 &#39;random_state&#39;: 0}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the prediction on the meshed x-axis (ask for MSE as well)</span>
<span class="n">y_pred</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">return_std</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span><span class="o">.</span><span class="n">kernel_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.27**2 * RBF(length_scale=1.32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the function, the prediction and the 95% confidence interval based on</span>
<span class="c1"># the MSE</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_test</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$f(x) = x\,\sin(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x_test</span><span class="p">,</span> <span class="n">x_test</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]),</span>
         <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_pred</span> <span class="o">-</span> <span class="mf">1.9600</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">,</span>
                        <span class="p">(</span><span class="n">y_pred</span> <span class="o">+</span> <span class="mf">1.9600</span> <span class="o">*</span> <span class="n">sigma</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]]),</span>
         <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;95</span><span class="si">% c</span><span class="s1">onfidence interval&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f02a0ad6d68&gt;
</pre></div>
</div>
<img alt="_images/001_gaussian-proceses_38_1.png" src="_images/001_gaussian-proceses_38_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span><span class="o">.</span><span class="n">log_marginal_likelihood</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-4.604661310251727
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;alpha&#39;: 1e-10,
 &#39;copy_X_train&#39;: True,
 &#39;kernel&#39;: 1**2 * RBF(length_scale=0.004),
 &#39;kernel__k1&#39;: 1**2,
 &#39;kernel__k1__constant_value&#39;: 1.0,
 &#39;kernel__k1__constant_value_bounds&#39;: (0.001, 1000.0),
 &#39;kernel__k2&#39;: RBF(length_scale=0.004),
 &#39;kernel__k2__length_scale&#39;: 0.004,
 &#39;kernel__k2__length_scale_bounds&#39;: (1e-05, 100000.0),
 &#39;n_restarts_optimizer&#39;: 10,
 &#39;normalize_y&#39;: False,
 &#39;optimizer&#39;: &#39;fmin_l_bfgs_b&#39;,
 &#39;random_state&#39;: 0}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gp</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;alpha&#39;: 1e-10,
 &#39;copy_X_train&#39;: True,
 &#39;kernel&#39;: 1.05**2 * RBF(length_scale=1.05),
 &#39;kernel__k1&#39;: 1.05**2,
 &#39;kernel__k1__constant_value&#39;: 1.0985999999999991,
 &#39;kernel__k1__constant_value_bounds&#39;: (0.001, 1000.0),
 &#39;kernel__k2&#39;: RBF(length_scale=1.05),
 &#39;kernel__k2__length_scale&#39;: 1.050299999999999,
 &#39;kernel__k2__length_scale_bounds&#39;: (1e-05, 100000.0),
 &#39;n_restarts_optimizer&#39;: 0,
 &#39;normalize_y&#39;: False,
 &#39;optimizer&#39;: &#39;fmin_l_bfgs_b&#39;,
 &#39;random_state&#39;: 0}
</pre></div>
</div>
</div>
</div>
<p>From https://scikit-learn.org/stable/auto_examples/gaussian_process/plot_gpr_noisy.html</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span>
<span class="c1"># Plot LML landscape</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="c1"># noise level</span>
<span class="n">theta0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">49</span><span class="p">)</span>
<span class="c1"># length scale</span>
<span class="n">theta1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">Theta0</span><span class="p">,</span> <span class="n">Theta1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">theta0</span><span class="p">,</span> <span class="n">theta1</span><span class="p">)</span>
<span class="n">LML</span> <span class="o">=</span> <span class="p">[[</span><span class="n">gp</span><span class="o">.</span><span class="n">log_marginal_likelihood</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">([</span><span class="n">Theta0</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">Theta1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]]))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Theta0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Theta0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
<span class="n">LML</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">LML</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

<span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">LML</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="p">(</span><span class="o">-</span><span class="n">LML</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="c1">#vmax = 50</span>
<span class="n">level</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">vmin</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">vmax</span><span class="p">),</span> <span class="mi">50</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">LML</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span> <span class="n">LML</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">min_theta0</span> <span class="o">=</span> <span class="n">theta0</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">min_theta1</span> <span class="o">=</span> <span class="n">theta1</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">theta0</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">theta1</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">Theta0</span><span class="p">,</span> <span class="n">Theta1</span><span class="p">,</span> <span class="o">-</span><span class="n">LML</span><span class="p">,</span>
            <span class="n">levels</span><span class="o">=</span><span class="n">level</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Noise-level&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Length-scale&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Log-marginal-likelihood </span><span class="se">\n</span><span class="s2"> Noise </span><span class="si">{</span><span class="n">min_theta0</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> Length </span><span class="si">{</span><span class="n">min_theta1</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> Likelihood </span><span class="si">{</span><span class="n">LML</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/001_gaussian-proceses_43_0.png" src="_images/001_gaussian-proceses_43_0.png" />
</div>
</div>
<div class="toctree-wrapper compound">
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="content.html" title="previous page">Content in Jupyter Book</a>
    <a class='right-next' id="next-link" href="markdown.html" title="next page">Markdown Files</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By AnotherMLStudent<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'G-ZJ79CQ4Z6Z', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>